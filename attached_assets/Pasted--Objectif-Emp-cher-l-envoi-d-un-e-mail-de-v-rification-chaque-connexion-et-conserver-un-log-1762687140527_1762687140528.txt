# üéØ Objectif
Emp√™cher l‚Äôenvoi d‚Äôun e-mail de v√©rification √† chaque connexion,  
et conserver un login classique avec ‚Äúemail + mot de passe‚Äù.

---

## ‚öôÔ∏è √âtapes √† suivre

### 1Ô∏è‚É£ Ouvre le fichier d‚Äôauthentification
Ouvre ton fichier :
```
/pages/api/auth/[...nextauth].js
```
ou
```
/api/auth/[...nextauth].js
```

---

### 2Ô∏è‚É£ Supprime le bloc EmailProvider (celui qui envoie les mails √† chaque login)
Cherche un bloc ressemblant √† ceci :

```js
import EmailProvider from "next-auth/providers/email";

providers: [
  EmailProvider({
    sendVerificationRequest({ identifier, url, provider }) {
      // Envoi du mail de v√©rification automatique
      await sendEmail(identifier, url);
    },
  }),
];
```

‚û°Ô∏è **Supprime compl√®tement ce bloc.**  
C‚Äôest lui qui provoque l‚Äôenvoi de mail √† chaque connexion.

---

### 3Ô∏è‚É£ Remplace-le par un CredentialsProvider classique

Ajoute ce code √† la place :

```js
import CredentialsProvider from "next-auth/providers/credentials";
import { prisma } from "@/lib/prisma"; // adapte selon ton projet

export const authOptions = {
  providers: [
    CredentialsProvider({
      name: "Connexion standard",
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Mot de passe", type: "password" },
      },
      async authorize(credentials) {
        // V√©rifie si l'utilisateur existe
        const user = await prisma.user.findUnique({
          where: { email: credentials.email },
        });

        if (!user) {
          throw new Error("Utilisateur non trouv√©.");
        }

        // V√©rifie le mot de passe (si tu hashes les mots de passe avec bcrypt)
        const bcrypt = await import("bcryptjs");
        const isValid = await bcrypt.compare(credentials.password, user.password);

        if (!isValid) {
          throw new Error("Mot de passe incorrect.");
        }

        return user;
      },
    }),
  ],
  session: {
    strategy: "jwt",
  },
  pages: {
    signIn: "/login", // page de connexion
    newUser: "/register", // page d'inscription
  },
};
```

---

### 4Ô∏è‚É£ Sauvegarde et relance ton projet

Dans la console Replit :
```
npm install next-auth bcryptjs
```
puis clique sur ‚ñ∂Ô∏è **Run**

---

### 5Ô∏è‚É£ Test

- Essaie de te **connecter** avec ton email et ton mot de passe.  
  ‚Üí Aucun mail de v√©rification ne sera envoy√©.  
- Essaie de **changer ton mot de passe**.  
  ‚Üí Le changement se fera sans qu‚Äôun mail ‚Äúmagique‚Äù parte automatiquement.  
- Si tu veux garder **un e-mail de v√©rification uniquement √† l‚Äôinscription**,  
  g√®re-le manuellement dans ton code d‚Äôinscription (ex: `register.js`).

---

## ‚úÖ R√©sum√©

| Situation | Action |
|------------|---------|
| Un mail part √† chaque connexion | ‚ùå Supprimer EmailProvider |
| Connexion classique | ‚úÖ Ajouter CredentialsProvider |
| V√©rification uniquement √† l‚Äôinscription | ‚úÖ G√©r√©e manuellement (ou via Resend) |
| Mot de passe v√©rifi√© avec bcrypt | ‚úÖ S√©curis√© |

---

## üß† R√©sultat attendu
- ‚úÖ Login par **email + mot de passe** (classique, rapide)  
- üö´ Plus de mail ‚Äúde v√©rification‚Äù √† chaque login  
- ‚úâÔ∏è Mail de v√©rification uniquement lors de l‚Äôinscription (optionnel)
