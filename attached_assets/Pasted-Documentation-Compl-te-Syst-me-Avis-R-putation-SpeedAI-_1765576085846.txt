Documentation Compl√®te - Syst√®me Avis & R√©putation SpeedAI
1. Vue d'Ensemble
Le syst√®me Avis & R√©putation permet de :

Collecter automatiquement des avis apr√®s les interactions client
Inciter les clients avec des offres promotionnelles (r√©ductions, cadeaux)
Centraliser tous les avis de diff√©rentes plateformes (Google, TripAdvisor, Facebook, etc.)
Analyser la r√©putation avec statistiques et insights IA
R√©pondre aux avis depuis le dashboard
G√©n√©rer des QR codes et widgets int√©grables
2. Architecture Base de Donn√©es (7 Tables)
Table review_config (1 par utilisateur)
Configuration globale du syst√®me.

Champ	Description
enabled	Syst√®me activ√©/d√©sactiv√©
timing_mode	Mode d'envoi : smart / fixed_delay / fixed_time
fixed_delay_hours	D√©lai d'envoi en heures
fixed_time	Heure fixe d'envoi (ex: "18:00")
send_window_start/end	Fen√™tre horaire autoris√©e
avoid_weekends	Ne pas envoyer le weekend
company_name	Nom affich√© dans les messages
sms_message	Template SMS personnalis√©
email_subject/message	Template email personnalis√©
google_review_url, tripadvisor_url, facebook_page_url, etc.	URLs des plateformes
platforms_priority	Ordre d'affichage des plateformes
Table review_incentives (Plusieurs par utilisateur)
Offres incitatives pour encourager les avis.

Type	Description	Exemple
percentage	R√©duction en %	-10% sur la prochaine visite
fixed_amount	R√©duction en ‚Ç¨	-5‚Ç¨ sur le prochain achat
free_item	Article offert	Un caf√© offert
lottery	Tirage au sort	Gagnez un iPhone
loyalty_points	Points fid√©lit√©	100 points offerts
custom	Personnalis√©	Texte libre
Chaque incitation a : validity_days, single_use, minimum_purchase, is_default

Table review_requests (Demandes d'avis)
Suivi de chaque demande envoy√©e.

Champ	Description
customer_name/email/phone	Coordonn√©es client
reservation_id/date/time	Infos r√©servation
send_method	email / sms / both
tracking_token	Token unique format: rv_{timestamp}_{random}
status	pending ‚Üí scheduled ‚Üí sent ‚Üí clicked ‚Üí confirmed / expired
incentive_id	FK vers l'incitation utilis√©e
promo_code	Code promo g√©n√©r√© apr√®s confirmation
Table reviews (Avis centralis√©s)
Stockage de tous les avis r√©cup√©r√©s.

Champ	Description
platform	google/tripadvisor/facebook/yelp/doctolib/pages_jaunes
rating	Note 1-5
content	Texte de l'avis
reviewer_name	Nom de l'auteur
response_text	R√©ponse du propri√©taire
response_status	none / draft / published
sentiment	very_positive / positive / neutral / negative / very_negative
is_read / is_flagged	Marqueurs de gestion
Table review_alerts
Configuration des alertes.

Type	Description
negative_review	Nouvel avis 1-2 √©toiles
new_5_star	Nouvel avis 5 √©toiles
no_response_48h	Avis sans r√©ponse >48h
weekly_report	Rapport hebdomadaire
rating_drop	Baisse de la note moyenne
Table review_sources (Connexions plateformes)
Sources OAuth pour synchronisation automatique (Google, Facebook, TripAdvisor).

Table review_sync_logs
Historique des synchronisations.

3. Pages du Dashboard
A. ReviewsStats - Statistiques
URL: /dashboard/reviews/stats

KPI Cards :

Note globale (avec √©toiles visuelles)
Total des avis + nouveaux sur la p√©riode
Taux de r√©ponse aux avis
Temps moyen de r√©ponse
R√©partition du sentiment
Graphiques :

Distribution par note (1-5 √©toiles)
Distribution du sentiment (Pie Chart)
Tendance des avis dans le temps
Comparaison par plateforme
Filtres : Cette semaine / Ce mois / Cette ann√©e / Tout le temps

Bouton IA : "G√©n√©rer des insights" - Analyse IA des tendances

B. ReviewsList - Tous les Avis
URL: /dashboard/reviews/list

Liste de tous les avis centralis√©s
Filtres par plateforme, note, sentiment
Barre de recherche textuelle
Pour chaque avis : avatar, √©toiles, plateforme, contenu, date, badge sentiment, indicateurs lu/flagged
Actions : Ouvrir d√©tail, r√©diger r√©ponse, marquer lu, flagger
C. ReviewsCampaigns - Campagnes de Demandes
URL: /dashboard/reviews/campaigns

KPI Cards :

Demandes envoy√©es
Taux de clic
Avis confirm√©s
Taux de conversion
Codes promo g√©n√©r√©s/utilis√©s
Tableau des demandes : Client, M√©thode d'envoi, Date, Statut, Actions

Statuts :

Statut	Couleur	Description
En attente	Gris	Cr√©√©e, pas encore envoy√©e
Planifi√©	Ambre	Programm√©e pour envoi
Envoy√©	Bleu	Message envoy√©
Cliqu√©	Or	Client a cliqu√© sur le lien
Converti	Vert	Avis confirm√©
Expir√©	Rouge	Pas de r√©ponse dans le d√©lai
Bouton "Nouvelle demande" : Formulaire avec nom, email, t√©l√©phone, m√©thode d'envoi, incitation

D. ReviewsSettings - Configuration
URL: /dashboard/reviews/settings

Sections :

Activation : Switch ON/OFF
Timing d'envoi : Mode (Smart/D√©lai fixe/Heure fixe), fen√™tre d'envoi, √©viter weekends
Informations entreprise : Nom affich√©
Messages personnalis√©s : Template SMS, sujet email, corps email
URLs des plateformes : Google, TripAdvisor, Facebook, Yelp, Doctolib, Pages Jaunes + ordre de priorit√©
Gestion des incitations : Liste, ajout, d√©finir par d√©faut, supprimer
Connexions Plateformes : OAuth Google/Facebook, URL TripAdvisor, statuts, sync manuelle
Configuration des alertes : Activer/d√©sactiver par type, options de notification
E. ReviewsWidgets - QR Codes & Widgets
URL: /dashboard/reviews/widgets

Onglet QR Code :

Preview en temps r√©el
Configuration : taille, couleurs, marge, plateforme cible
Boutons : T√©l√©charger PNG, Copier
Onglet Widget Avis :

Preview interactive
Configuration : th√®me, nombre d'avis max, afficher plateforme/date, auto-scroll, dimensions
Code iframe √† copier
Onglet Badge de Note :

Preview du badge
Configuration : style, afficher nombre d'avis, plateforme
Code HTML √† copier
F. ReviewPage - Page Publique avec Token
URL: /review/{tracking_token}

Page utilis√©e par les liens dans les emails/SMS :

Affichage des plateformes disponibles
Si incitation ‚Üí affichage de l'offre
Client clique sur plateforme ‚Üí ouverture nouvel onglet
Bouton "J'ai laiss√© mon avis"
Clic ‚Üí g√©n√©ration code promo
Affichage du code avec bouton copier
G. ReviewCollect - Page Publique QR Code
URL: /review/collect?userId={id}&platform={platform}

Page accessible via QR code :

Si platform sp√©cifi√© ‚Üí redirection automatique
Sinon ‚Üí affichage liste des plateformes configur√©es
H. ReviewsEmbed - Widget Int√©grable (iframe)
URL: /embed/reviews?userId={id}&theme=dark&max=5

Widget pour sites externes avec note globale, nombre d'avis, carrousel des derniers avis.

4. Parcours Utilisateur (Client SpeedAI)
Configuration Initiale
Activer le syst√®me (switch ON)
Configurer le timing (mode, fen√™tre, weekends)
Renseigner les URLs des plateformes
Personnaliser les messages (optionnel)
Cr√©er des incitations (optionnel)
Configurer les alertes (optionnel)
Demande Manuelle
Aller dans Campagnes ‚Üí "Nouvelle demande"
Remplir : Nom, Email/T√©l√©phone, M√©thode, Incitation
Cliquer "Cr√©er"
Cliquer "Envoyer" ou laisser le timing automatique
Automatisation via N8N
[Appel termin√©] ‚Üí [Webhook N8N] ‚Üí [POST create-request] ‚Üí [Demande cr√©√©e]
‚Üí [WAIT d√©lai] ‚Üí [POST send-request] ‚Üí [Email/SMS envoy√©]

5. Parcours Client Final (Destinataire)
√âtape 1 : R√©ception du Message
Email :

De: noreply@speedai.fr
Objet: Partagez votre exp√©rience avec [Nom Entreprise]
Bonjour Jean,
Merci pour votre visite !
üéÅ En remerciement : -10% sur votre prochaine visite
[Laisser mon avis]

SMS :

[Entreprise]: Bonjour Jean ! üéÅ -10% en cadeau
üëâ Donnez votre avis: https://speedai.fr/review/rv_xxx

√âtape 2 : Clic sur le Lien
Le client arrive sur la page /review/rv_xxx :

Affichage de l'offre incitative
Liste des plateformes (Google, TripAdvisor, Facebook...)
Bouton "J'ai laiss√© mon avis"
√âtape 3 : Choix et Avis
Client clique sur "Google"
Nouvel onglet ‚Üí page Google pour laisser avis
Client r√©dige et publie son avis
√âtape 4 : Confirmation
Client clique "J'ai laiss√© mon avis"
Code promo g√©n√©r√© automatiquement
√âtape 5 : R√©ception du Code
‚úì Merci beaucoup !
üéÅ Votre code promo :
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   MERCI-A7B2C9   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
Pr√©sentez ce code lors de votre prochaine visite
-10% sur votre prochaine visite
Valable 30 jours

Format code promo : MERCI-{6 caract√®res al√©atoires majuscules}

6. Int√©gration N8N
Authentification
Header : Authorization: Bearer <N8N_MASTER_API_KEY>

Endpoints
1. Cr√©er une Demande

POST /api/n8n/reviews/create-request
{
  "client_email": "restaurant@example.com",
  "customer_name": "Jean Dupont",
  "customer_email": "jean@email.com",
  "customer_phone": "+33612345678",
  "send_method": "email"
}

2. Envoyer une Demande

POST /api/n8n/reviews/send-request
{ "request_id": "uuid-xxx" }

3. R√©cup√©rer Demandes en Attente

GET /api/n8n/reviews/pending-requests?max_age_hours=48&ready_only=true

4. Marquer comme Envoy√©es

POST /api/n8n/reviews/mark-sent
{ "request_ids": ["uuid-1", "uuid-2"] }

Workflow Type
[Appel termin√©] ‚Üí [IF: RDV confirm√©?] ‚Üí [POST create-request]
‚Üí [WAIT 2h] ‚Üí [POST send-request] ‚Üí [Fin]

7. Widgets & QR Codes
QR Code
URL g√©n√©r√©e : https://speedai.fr/review/collect?userId={id}&platform={platform}

Usage : Imprimer pour affichage en √©tablissement, factures, tables

Widget Iframe
<iframe 
  src="https://speedai.fr/embed/reviews?userId={id}&theme=dark&max=5"
  width="400" height="300" frameborder="0"
></iframe>

Param√®tres : theme, max, showPlatform, showDate, autoScroll

8. Synchronisation Multi-Plateformes
Plateforme	Connexion	Sync
Google Business Profile	OAuth 2.0	Auto (cron 4h)
Facebook Pages	OAuth 2.0	Auto (cron 4h)
TripAdvisor	URL manuelle	Auto (cron 4h)
Yelp, Doctolib, Pages Jaunes	URL manuelle	Manuelle
9. Points Cl√©s
Deux flux de collecte : Via token email/SMS ou via QR code direct
Code promo g√©n√©r√© UNIQUEMENT apr√®s confirmation de l'avis
Le SMS est pr√©par√© pour N8N qui g√®re l'envoi via Twilio
Synchronisation auto √† 4h00 Paris
Incitations optionnelles - le syst√®me fonctionne sans
Format token : rv_{timestamp_ms}_{random_9_chars}
