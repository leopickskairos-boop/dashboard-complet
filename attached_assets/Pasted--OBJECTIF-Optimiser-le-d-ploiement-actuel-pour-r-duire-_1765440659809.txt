ğŸ¯ OBJECTIF :
Optimiser le dÃ©ploiement actuel pour rÃ©duire au maximum lâ€™usage dâ€™Autoscale Compute Units et la facture liÃ©e aux Deployments Replit, sans modifier la logique mÃ©tier ni les fonctionnalitÃ©s existantes du dashboard.

ğŸ—ï¸ CONTEXTE :
- App Next.js / Node.js hÃ©bergÃ©e sur Replit avec Autoscale activÃ©.
- Le dashboard tourne 24/7 alors quâ€™il devrait sâ€™endormir quand il nâ€™y a aucun trafic.
- Le compute se dÃ©clenche trop souvent : warm-ups, rebuilds, Ã©coute de ports, fetch internes, interval loops.
- Le but est dâ€™obtenir un comportement propre : *idle â†’ sleep* et *wake â†’ serve*, avec un minimum dâ€™instanciations.

âš ï¸ CONTRAINTES :
- Ne pas modifier le design ni les fonctionnalitÃ©s.
- Ne pas toucher Ã  la base de donnÃ©es ni aux endpoints API.
- Ne pas supprimer des features.
- Optimisation pure : performance, consommation, autoscale.

ğŸ“Œ TÃ‚CHES Ã€ EFFECTUER :

1. **Optimiser la configuration serveur**
   - VÃ©rifier que lâ€™app nâ€™ouvre quâ€™un seul serveur HTTP.
   - EmpÃªcher lâ€™instanciation multiple dans Autoscale.
   - Sâ€™assurer quâ€™aucun process â€œwatcherâ€ ou â€œintervalâ€ ne force lâ€™app Ã  rester Ã©veillÃ©e.
   - DÃ©sactiver toute boucle interne inutile ou polling non essentiel.

2. **Rendre lâ€™application compatible â€œsleep modeâ€**
   - Supprimer ou rÃ©duire tout background-task qui empÃªche lâ€™endormissement du container.
   - Ajouter un mÃ©canisme pour que lâ€™app ne traite rien tant quâ€™il nâ€™y a pas de requÃªte entrante.
   - Garantir que Next.js ou Express ne tourne pas en mode dev mais en mode production optimisÃ©.

3. **RÃ©duire les triggers de rÃ©veil**
   - Identifier les fetch / API calls / WebSockets qui rÃ©veillent lâ€™Autoscale.
   - Ã‰liminer les pings internes, health checks trop frÃ©quents ou appels silencieux.
   - Regrouper les tÃ¢ches CRON Ã  lâ€™extÃ©rieur (cron-job.org ou N8N).

4. **Optimiser le bundle**
   - Activer le strict production mode.
   - Supprimer les devDependencies du runtime.
   - Ã‰viter les imports lourds cÃ´tÃ© serveur.

5. **Optimiser le warm-up**
   - AmÃ©liorer le cold start de lâ€™app.
   - PrÃ©compiler ce qui peut lâ€™Ãªtre.
   - RÃ©duire la taille du serveur.

6. **Audit final**
   - Me retourner un rÃ©sumÃ© des optimisations effectuÃ©es.
   - Me lister clairement les points qui auraient empÃªchÃ© la mise en â€œsleepâ€.
   - Me proposer les 3 meilleurs rÃ©glages Autoscale recommandÃ©s :
        â€¢ minInstances = 0  
        â€¢ maxInstances = 1  
        â€¢ idleTimeout = 300 secondes (ou moins si possible)

ğŸ§© LIVRABLE ATTENDU :
- Refactor minimal, ciblÃ© uniquement sur l'infrastructure et les comportements serveur.
- Code propre, stable, compatible avec Replit Autoscale.
- Aucun impact sur lâ€™expÃ©rience utilisateur finale.