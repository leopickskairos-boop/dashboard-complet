# ğŸ¯ Objectif
Modifier la logique dâ€™affichage des appels pour que, dans le dÃ©tail des appels affichÃ©s sur le dashboard,  
**seuls les appels avec rendez-vous pris** apparaissent.

---

## ğŸ” Contexte actuel
Actuellement, la section â€œDÃ©tails des appelsâ€ affiche **tous les appels**, sans distinction.  
Je veux quâ€™elle affiche uniquement les appels dont le statut est **â€œrendez-vous prisâ€** (ou `appointment: true`).

---

## âš™ï¸ Ce quâ€™il faut faire

### 1ï¸âƒ£ CÃ´tÃ© base de donnÃ©es / modÃ¨le
VÃ©rifie que la table (ou collection) des appels contient bien un champ indiquant le statut du rendez-vous :
```js
{
  id: Int,
  userId: Int,
  caller: String,
  date: DateTime,
  duration: Int,
  hasAppointment: Boolean, // âœ… ce champ sert de filtre
  appointmentDate: DateTime? // optionnel
}
```

---

### 2ï¸âƒ£ CÃ´tÃ© requÃªte backend
Dans la route qui renvoie les appels (souvent `/api/calls` ou `/api/get-calls`),  
il faut filtrer uniquement ceux avec un rendez-vous confirmÃ©.

Exemple Prisma :
```js
app.get("/api/calls", requireAuth, async (req, res) => {
  const userId = req.user.id;

  const calls = await prisma.call.findMany({
    where: {
      userId,
      hasAppointment: true, // âœ… filtre ajoutÃ© ici
    },
    orderBy: {
      date: "desc",
    },
  });

  res.json(calls);
});
```

Si tu utilises une autre base :
```js
db.collection("calls").find({ userId, hasAppointment: true });
```

---

### 3ï¸âƒ£ CÃ´tÃ© front (React / Dashboard)
Quand tu charges les appels dans le composant du dashboard :
```js
useEffect(() => {
  fetch("/api/calls")
    .then(res => res.json())
    .then(data => setCalls(data.filter(call => call.hasAppointment)));
}, []);
```

Et dans la partie affichage â€œDÃ©tails des appelsâ€ :
```jsx
{calls.map(call => (
  <CallDetailCard
    key={call.id}
    caller={call.caller}
    date={call.date}
    appointmentDate={call.appointmentDate}
  />
))}
```

---

### 4ï¸âƒ£ Option supplÃ©mentaire (Ã  ton choix)
Si tu veux garder tous les appels, mais **pouvoir filtrer via un bouton â€œRendez-vous prisâ€** :

```jsx
<Button onClick={() => setCalls(calls.filter(c => c.hasAppointment))}>
  Rendez-vous pris âœ…
</Button>
```

---

### âœ… RÃ©sultat attendu

| Section | Contenu affichÃ© |
|----------|-----------------|
| ğŸ“ DÃ©tails des appels | âœ… Seulement les appels oÃ¹ un rendez-vous est pris |
| âŒ Appels sans rendez-vous | Non affichÃ©s |
| ğŸ—“ï¸ DonnÃ©es affichÃ©es | Nom, date, heure, durÃ©e, date du rendez-vous |
| ğŸ” Actualisation | Dynamique via le fetch backend filtrÃ© |

---

## ğŸ“‹ En rÃ©sumÃ©
- Ajoute ou vÃ©rifie le champ `hasAppointment` dans le modÃ¨le `call`.  
- Filtre `where: { hasAppointment: true }` dans la requÃªte backend.  
- Le dashboard affiche uniquement ces appels dans la section â€œDÃ©tailsâ€.

---

## ğŸ§© RÃ©sultat final visuel
```
[ DÃ©tails des Appels ]
-----------------------------------------
ğŸ“… 09/11/2025 â€” Jean Dupont â€” Rendez-vous 14h00 âœ…
ğŸ“… 08/11/2025 â€” Sarah Lemoine â€” Rendez-vous 10h30 âœ…
-----------------------------------------
(Tous les autres appels non concernÃ©s sont masquÃ©s)
```
